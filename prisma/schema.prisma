generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model tenant {
  id              String        @id(map: "tenants_pkey") @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name            String        @unique(map: "tenants_name_key") @db.VarChar
  created_at      DateTime      @default(now()) @db.Timestamp(6)
  updated_at      DateTime      @default(now()) @db.Timestamp(6)
  is_multi_tenant Boolean       @default(false)
  tenant_user     tenant_user[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model tenant_user {
  tenant_id  String   @db.Uuid
  user_id    String   @db.Uuid
  role       String   @default("user")
  created_at DateTime @default(now()) @db.Timestamp(6)
  tenant     tenant   @relation(fields: [tenant_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "tenant_user_tenant_id_fk")
  user       user     @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "tenant_user_user_id_fk")

  @@id([user_id, tenant_id], map: "tenant_user_pk")
}

model user {
  id              String        @id(map: "users_pkey") @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  email           String        @unique(map: "users_email_key")
  username        String
  hashed_password String
  is_active       Boolean       @default(true)
  created_at      DateTime      @default(now()) @db.Timestamptz(6)
  updated_at      DateTime      @default(now()) @db.Timestamptz(6)
  tenant_user     tenant_user[]
}
